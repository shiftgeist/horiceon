#!/usr/bin/env zsh

# path for plugins
ZSHPATH="${XDG_DATA_HOME:-$HOME/.local/share}/zsh"

# If not running interactively, don't do anything
[[ $- != *i* ]] && return

# Include custom dir to fpath
fpath=(
    "$ZSHPATH"
    $fpath
)

autoload -U promptinit; promptinit;

autoload -U compinit
compinit
zstyle ':completion:*' menu yes select
zstyle ':completion:*' matcher-list '' 'm:{a-zA-Z}={A-Za-z}'
_comp_options+=(globdots) # Include hidden files.

autoload -U select-word-style
select-word-style bash
stty stop undef

setopt auto_cd

export GUNTER="Miami"
HISTSIZE=10000000
SAVEHIST=10000000
HISTFILE=~/.cache/zsh/history
setopt inc_append_history
setopt share_history

# Plugins
source $ZSHPATH/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source $ZSHPATH/zsh-you-should-use/you-should-use.plugin.zsh
source /usr/share/zsh/vendor-completions/_fzf

# Load additional zsh alias/plugins
[ -f "${XDG_CONFIG_HOME:-$HOME/.config}/aliasrc" ] && source "${XDG_CONFIG_HOME:-$HOME/.config}/aliasrc"

# Load untracked zshrc
if [ -f ~/.zshrc_local ]; then
    source ~/.zshrc_local
fi

# Set emulator title
# https://tldp.org/HOWTO/Xterm-Title-4.html
case $TERM in
    xterm*)
        precmd () {print -Pn "\e]0;%n@%m: %~\a"}
        ;;
esac

# Keybinds
bindkey "$terminfo[kcuu1]" history-search-backward
bindkey "$terminfo[kcud1]" history-search-forward

# Emacs key mode
bindkey -e

# Init prompt
eval "$(starship init zsh)"
