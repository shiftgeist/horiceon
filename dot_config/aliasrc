#!/usr/bin/env zsh

# Rice
alias horiceon="cd ~/.local/share/horiceon"

# Helper
alias syslog-crit="sudo dmesg -w -l err,warn"
alias syslog="sudo dmesg -w"

alias battery-status="upower -i /org/freedesktop/UPower/devices/battery_BAT0 | grep -E 'state|time\ to\ full|percentage'"
alias docker-cleanup="echo 'Cleaning docker images older than 24h' && docker image prune -a --filter 'until=24h'"
alias emoji="less ~/.local/share/emoji"
alias find-broken-symlinks="find ~/ -xtype l -print"
alias fonts="fc-list"
alias fonts-rebuild="fc-cache -f -v"
alias x-refresh-db="xrdb ~/.Xresources"
alias select-file="xsel -b <"
alias untar="tar xvf"
alias untargz="tar zxvf"
alias untarxz="tar xf"
alias untarbz2="tar xjf"

alias gbc="git branch --merged | egrep -v '(^\*|master|dev)' | xargs git branch -d && git pull --prune"
alias nlsg0="npm list -g --depth=0"
alias nv="npm version --no-git-tag-version"
alias ports="netstat -tlpn"
alias zsh-debug="zsh -xv"

# git

# Outputs the name of the current branch
# Usage example: git pull origin $(git_current_branch)
# Using '--quiet' with 'symbolic-ref' will not cause a fatal error (128) if
# it's not a symbolic ref, but in a Git repo.
function git_current_branch() {
  local ref
  ref=$(__git_prompt_git symbolic-ref --quiet HEAD 2> /dev/null)
  local ret=$?
  if [[ $ret != 0 ]]; then
    [[ $ret == 128 ]] && return  # no git repo.
    ref=$(__git_prompt_git rev-parse --short HEAD 2> /dev/null) || return
  fi
  echo ${ref#refs/heads/}
}

alias gcmsg='git commit -m'
alias gco='git checkout'
alias gcos="git for-each-ref --format='%(refname:short)' refs/heads | fzf | xargs git checkout"

alias gp='git push'
alias gpf='git push --force-with-lease'
alias gpsup='git push --set-upstream origin $(git_current_branch)'

alias gl='git pull'

alias glog='git log --oneline --decorate --graph'
alias gloga='git log --oneline --decorate --graph --all'
alias gst='git status'
alias gd="git diff"
alias gt="git tag | sort -h"
alias gdesc="git describe --tags $(git rev-list --tags --max-count=1)"

# directories

alias la='ls -lAh'
alias ...="cd ../.."
alias ....="cd ../../.."
alias .....="cd ../../../.."

# npm

alias npmg="npm i -g "
alias npmS="npm i -S "
alias npmD="npm i -D "
alias npmE='PATH="$(npm bin)":"$PATH"'
alias npmO="npm outdated"
alias npmV="npm -v"
alias npmL="npm list"
alias npmL0="npm ls --depth=0"
alias npmst="npm start"
alias npmt="npm test"
alias npmR="npm run"
alias npmP="npm publish"
alias npmI="npm init"
